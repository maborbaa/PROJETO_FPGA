# Arquivo: pins.lpf
# Mapeamento para Colorlight i9 (Lattice ECP5)

# 1. Clock Principal (25MHz)
# Na Colorlight i9, o oscilador de 25MHz está sempre no pino P3
# LOCATE COMP "clk_in" SITE "P3";
# IOBUF PORT "clk_in" IO_TYPE=LVCMOS33;

# 2. Reset (Botão ou Pull-up)
# Usar um pino que geralmente tem botão ou deixamos flutuando com Pull-up interno
# K18 é comum nessas placas, mas se não tiver botão, o PULLMODE=UP segura o reset solto
# LOCATE COMP "rst_in" SITE "K18";
# IOBUF PORT "rst_in" IO_TYPE=LVCMOS33 PULLMODE=UP;

# 3. LED de Teste (Led Vermelho da Placa)
# O LED da Colorlight i9 fica no pino L16 e acende com nível BAIXO (invertido)
# LOCATE COMP "led[0]" SITE "L16";
# IOBUF PORT "led[0]" IO_TYPE=LVCMOS33;

# (Os outros LEDs do vetor [7:1] não precisamos mapear agora, o Nextpnr vai ignorar)

# Testar SPI acender um LED

# --- Mapeamento para Colorlight i9 (ECP5-45) ---

# --- Esquemático i5-i9-extboard ---

# 1. CLOCK (Padrão 25MHz)
LOCATE COMP "clk" SITE "P3";
IOBUF PORT "clk" IO_TYPE=LVCMOS33;

# 2. SERVO MOTOR (Fio Laranja)
# Vamos usar o pino L4 (Verifique se é acessível na sua placa)
LOCATE COMP "servo_pin" SITE "L4";
IOBUF PORT "servo_pin" IO_TYPE=LVCMOS33;

# 3. LEDS DE STATUS (Ligados na Protoboard)
# Renomeei para bater com o código "servo.sv"

# LED Verde (Indo) -> Antes era led[0] (N4)
LOCATE COMP "led_verde" SITE "N4";
IOBUF PORT "led_verde" IO_TYPE=LVCMOS33;

# LED Vermelho (Voltando) -> Antes era led[1] (P16)
LOCATE COMP "led_verm" SITE "P16";
IOBUF PORT "led_verm" IO_TYPE=LVCMOS33;

# Clock de 25MHz (P3 é padrão da Colorlight i9)
#LOCATE COMP "clk_in" SITE "P3";
#IOBUF PORT "clk_in" IO_TYPE=LVCMOS33;

# Botão (Reset) - PR20D (branco) -> Site K18 -- Botão Active High, Pull-Down ativado
#LOCATE COMP "rst" SITE "K18";
#IOBUF PORT "rst" IO_TYPE=LVCMOS33 PULLMODE=DOWN;

#LEDs (Active Low: 0=Aceso, 1=Apagado)
# LED 1 (Vermelho) - PL38C (azul) -> Site N4
#LOCATE COMP "led[0]" SITE "N4";
#IOBUF PORT "led[0]" IO_TYPE=LVCMOS33;

# LED 2 (Verde) - PR35B (marrom) -> Site P16
#LOCATE COMP "led[1]" SITE "P16";
#IOBUF PORT "led[1]" IO_TYPE=LVCMOS33;

# --- Interface SPI (Mapeamento) ---
# CS (PR5D (branco) -> F18) ==> GP17 (vermelho)
#LOCATE COMP "spi_cs" SITE "F18";
#IOBUF PORT "spi_cs" IO_TYPE=LVCMOS33;

# SCK (PR8D (verde) -> H16) ==> GP18 (laranja)
#LOCATE COMP "spi_sck" SITE "H16";
#IOBUF PORT "spi_sck" IO_TYPE=LVCMOS33;

# MOSI (PR11B (amarelo) -> H17) ==> GP19 (preto)
#LOCATE COMP "spi_mosi" SITE "H17";
#IOBUF PORT "spi_mosi" IO_TYPE=LVCMOS33;

# MISO (PR8B (azul) -> G18) ==> GP16 (marrom)
#LOCATE COMP "spi_miso" SITE "G18";
#IOBUF PORT "spi_miso" IO_TYPE=LVCMOS33;

## TECLADO MATRICIAL (Conforme Tabela)
## Linhas (Rows) - Saídas da FPGA (Scan)
#LOCATE COMP "row[0]" SITE "D1";  # R1 (Cinza)
#LOCATE COMP "row[1]" SITE "C2";  # R2 (Branco)
#LOCATE COMP "row[2]" SITE "B4";  # R3 (Preto)
#LOCATE COMP "row[3]" SITE "D3";  # R4 (Marrom)

#IOBUF PORT "row[0]" IO_TYPE=LVCMOS33;
#IOBUF PORT "row[1]" IO_TYPE=LVCMOS33;
#IOBUF PORT "row[2]" IO_TYPE=LVCMOS33;
#IOBUF PORT "row[3]" IO_TYPE=LVCMOS33;

## Colunas (Cols) - Entradas da FPGA (Leitura)
#LOCATE COMP "col[0]" SITE "C17"; # C1 (Vermelho)
#LOCATE COMP "col[1]" SITE "B18"; # C2 (Laranja)
#LOCATE COMP "col[2]" SITE "B20"; # C3 (Amarelo)
#LOCATE COMP "col[3]" SITE "F20"; # C4 (Verde)

##IOBUF PORT "col[0]" IO_TYPE=LVCMOS33 PULLMODE=DOWN;
##IOBUF PORT "col[1]" IO_TYPE=LVCMOS33 PULLMODE=DOWN;
##IOBUF PORT "col[2]" IO_TYPE=LVCMOS33 PULLMODE=DOWN;
##IOBUF PORT "col[3]" IO_TYPE=LVCMOS33 PULLMODE=DOWN;

#IOBUF PORT "col[0]" IO_TYPE=LVCMOS33 PULLMODE=UP;
#IOBUF PORT "col[1]" IO_TYPE=LVCMOS33 PULLMODE=UP;
#IOBUF PORT "col[2]" IO_TYPE=LVCMOS33 PULLMODE=UP;
#IOBUF PORT "col[3]" IO_TYPE=LVCMOS33 PULLMODE=UP;